# 项目概述

## 1. 项目简介

**选课系统 (Course Selection System)** 是一个基于 Go 语言开发的现代化选课管理平台，采用 Gin 框架构建 RESTful API，支持高并发场景下的课程选择操作。

### 1.1 核心功能

| 功能模块 | 描述 |
|---------|------|
| 用户认证 | 登录、登出、Session 管理、权限验证 |
| 成员管理 | 管理员、教师、学生三类用户的 CRUD 操作 |
| 课程管理 | 课程的创建、查询、教师绑定/解绑 |
| 选课服务 | 高并发场景下的课程预订、退选功能 |

### 1.2 技术栈

```
┌─────────────────────────────────────────────────────────────┐
│                        技术栈                                │
├─────────────────────────────────────────────────────────────┤
│  语言框架    │  Gin 1.9 + Go 1.24                            │
│  数据库      │  MySQL 8.0 + GORM 1.25                        │
│  缓存        │  Redis 7.x                                    │
│  消息队列    │  RocketMQ 4.9                                 │
│  认证        │  Session + bcrypt 密码加密                    │
│  配置管理    │  Viper                                        │
│  日志        │  Zap                                          │
│  部署        │  Docker + Docker Compose                      │
└─────────────────────────────────────────────────────────────┘
```

### 1.3 项目特点

- **分层架构**: 采用 Clean Architecture 清晰分离各层职责
- **高并发支持**: Redis 原子操作 + 消息队列处理高并发选课
- **安全认证**: Session 管理 + 细粒度权限控制
- **可扩展性**: 依赖注入设计，便于测试和扩展

---

## 2. 项目结构

```
Shuai-Course-Selection/
├── config.yaml                    # 配置文件
├── go.mod                         # Go 模块依赖
├── go.sum                         # 依赖校验
├── deploy/                        # Docker 部署配置
│   ├── Dockerfile
│   └── docker-compose.yml
├── sql/                           # SQL 脚本
│   ├── course_select_v1.01.sql
│   └── coures_select_v1.02.sql
├── learn_docs/                    # 学习文档
│   ├── 01-项目概述.md
│   ├── 02-项目架构详解.md
│   ├── 03-认证模块详解.md
│   ├── 04-成员管理模块.md
│   ├── 05-课程管理模块.md
│   ├── 06-选课模块详解.md
│   ├── 07-基础设施层详解.md
│   └── 08-部署与运维.md
└── internal/                      # 核心代码
    ├── application/               # 应用层
    │   ├── dto/                   # 数据传输对象
    │   └── service/               # 应用服务
    ├── domain/                    # 领域层
    │   ├── model/                 # 实体模型
    │   ├── repository/            # 仓储接口
    │   └── service/               # 领域服务
    ├── infrastructure/            # 基础设施层
    │   ├── database/              # 数据库实现
    │   ├── redis/                 # Redis 客户端
    │   ├── encrypt/               # 加密工具
    │   └── mq/                    # 消息队列
    └── interface/                 # 接口层
        └── api/
            ├── handler/           # HTTP 处理器
            ├── middleware/        # 中间件
            └── router/            # 路由配置
```

---

## 3. 用户角色

系统支持三种用户类型，通过 `user_type` 字段区分：

| user_type | 角色 | 权限描述 |
|-----------|------|----------|
| 1 | 管理员 | 系统管理，完全访问权限，可管理所有用户和课程 |
| 2 | 教师 | 课程管理、查看学生选课情况 |
| 3 | 学生 | 选课、退选、查看个人课表 |

---

## 4. 数据库表结构

### 4.1 核心表

| 表名 | 说明 |
|------|------|
| `member` | 用户成员表，存储所有用户信息 |
| `course` | 课程表，存储课程基本信息 |
| `choice` | 选课关系表，学生与课程的多对多关系 |
| `bind` | 教师课程绑定表，教师与课程的一对一关系 |

### 4.2 实体关系

```
┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│   Member    │       │   Course    │       │   Choice    │
├─────────────┤       ├─────────────┤       ├─────────────┤
│ UserID (PK) │───┐   │ CourseID(PK)│   ┌───│ StudentID   │
│ Username    │   │   │ Name        │   │   │ CourseID    │
│ Password    │   │   │ Capacity    │   │   │ SelectedAt  │
│ Nickname    │   │   │ TeacherID ──┼───┘   └─────────────┘
│ UserType    │   │   └─────────────┘
│ IsDeleted   │   │
└─────────────┘   │
      │           │
      │ Bind      │
      ▼           │
┌─────────────┐   │
│   Bind      │◄──┘
├─────────────┤
│ TeacherID   │
│ CourseID    │
│ AssignedAt  │
└─────────────┘
```

---

## 5. API 接口概览

### 5.1 认证模块

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| POST | `/api/v1/auth/login` | 用户登录 | 公开 |
| POST | `/api/v1/auth/logout` | 用户登出 | 需登录 |
| GET | `/api/v1/auth/whoami` | 获取当前用户信息 | 需登录 |

### 5.2 成员管理

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| GET | `/api/v1/member` | 获取单个成员 | 需登录 |
| GET | `/api/v1/member/list` | 获取成员列表 | 需登录 |
| POST | `/api/v1/member/create` | 创建成员 | 管理员 |
| POST | `/api/v1/member/update` | 更新成员 | 管理员 |
| POST | `/api/v1/member/delete` | 删除成员 | 管理员 |

### 5.3 课程管理

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| GET | `/api/v1/course/get` | 获取课程 | 需登录 |
| POST | `/api/v1/course/create` | 创建课程 | 管理员 |
| POST | `/api/v1/course/schedule` | 批量排课 | 管理员 |

### 5.4 教师管理

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| GET | `/api/v1/teacher/get_course` | 获取教师课程 | 需登录 |
| POST | `/api/v1/teacher/bind_course` | 绑定课程到教师 | 管理员 |
| POST | `/api/v1/teacher/unbind_course` | 解绑课程 | 管理员 |

### 5.5 学生选课

| 方法 | 路径 | 描述 | 权限 |
|------|------|------|------|
| POST | `/api/v1/student/book_course` | 预订课程 | 需登录 |
| GET | `/api/v1/student/course` | 获取学生课表 | 需登录 |

---

## 6. 快速开始

### 6.1 环境要求

- Go 1.24+
- MySQL 8.0
- Redis 7.x
- RocketMQ 4.9 (可选)

### 6.2 配置说明

编辑 `config.yaml`：

```yaml
# 数据库配置
database:
  host: "localhost"
  port: 3306
  username: "root"
  password: "${DB_PASSWORD}"
  name: "course_select"

# Redis 配置
redis:
  host: "localhost"
  port: 6379
  password: "${REDIS_PASSWORD}"

# RocketMQ 配置 (选课高并发场景)
rocketmq:
  nameserver: "localhost:9876"
```

### 6.3 启动服务

```bash
# 编译
go build -o server.exe .

# 运行
./server.exe
```

### 6.4 Docker 部署

```bash
docker-compose up -d
```

---

## 7. 下一步学习

建议按照以下顺序学习项目各模块：

1. **[项目架构详解](02-项目架构详解.md)** - 了解整体架构设计和分层思想
2. **[认证模块详解](03-认证模块详解.md)** - 学习 Session 管理和权限验证
3. **[基础设施层详解](07-基础设施层详解.md)** - 掌握数据库、Redis、消息队列的使用
4. **[选课模块详解](06-选课模块详解.md)** - 深入理解高并发场景处理
5. **[部署与运维](08-部署与运维.md)** - 了解生产环境部署方案
